(this["webpackJsonpmlw-react"]=this["webpackJsonpmlw-react"]||[]).push([[0],{29:function(t,e,n){},31:function(t,e,n){"use strict";n.r(e);var s=n(1),a=n.n(s),r=n(2),i=n(7),c=n(8),o=n(10),l=n(9),u=n(6),d=n.n(u),p=n(16),h=n.n(p),x=n(4),f=n(5),b=(n(29),n(11)),m=function(){function t(e,n,s){Object(i.a)(this,t),this.tblName=e,this.url=n,this.key=s}return Object(c.a)(t,[{key:"getAll",value:function(){var t=Object(r.a)(a.a.mark((function t(){var e,n=arguments;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:{},t.next=3,this.search([{c:"id",o:">",v:0}],e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"get",value:function(){var t=Object(r.a)(a.a.mark((function t(e){var n,s,r,i=arguments;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r in n=i.length>1&&void 0!==i[1]?i[1]:{},s=[],e)s.push({c:r,o:"=",v:e[r]});return t.next=5,this.search(s,n);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"search",value:function(){var t=Object(r.a)(a.a.mark((function t(e){var n,s,r=arguments;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},s="".concat(this.url,"/data/").concat(this.tblName,"?query=").concat(JSON.stringify(e)),!0===n.count&&(s+="&count=1"),n.limit&&(s+="&limit="+n.limit),n.offset&&(s+="&offset="+n.offset),n.select&&(s+="&select="+JSON.stringify(n.select)),n.order&&(s+="&order="+JSON.stringify(n.order)),s=encodeURI(s),t.next=10,fetch(s,{headers:{Authorization:"Bearer ".concat(this.key)}}).then((function(t){if(200===t.status)return t.json();var e=new CustomEvent("arachneError",{detail:{method:"search",status:t.status}});window.dispatchEvent(e)}));case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"delete",value:function(){var t=Object(r.a)(a.a.mark((function t(e){var n,s,r,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="".concat(this.url,"/data/").concat(this.tblName,"/").concat(e),s=null,Array.isArray(e)&&(n="".concat(this.url,"/data_batch/").concat(this.tblName),s=JSON.stringify(e)),t.next=5,fetch(n,{method:"delete",headers:{Authorization:"Bearer ".concat(this.key),"Content-Type":"application/json"},body:s});case 5:if(200!==(r=t.sent).status){t.next=10;break}return t.abrupt("return",!0);case 10:i=new CustomEvent("arachneError",{detail:{method:"delete",status:r.status}}),window.dispatchEvent(i);case 12:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"save",value:function(){var t=Object(r.a)(a.a.mark((function t(e){var n,s,r,i,c;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="POST",s="",r=1,Array.isArray(e)?s="".concat(this.url,"/data_batch/").concat(this.tblName):(s="".concat(this.url,"/data/").concat(this.tblName),r=e.id,null!=e.id&&(s+="/".concat(e.id),n="PATCH",delete e.id)),t.next=6,fetch(s,{method:n,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.key)},body:JSON.stringify(e)});case 6:if(201!==(i=t.sent).status||"POST"!==n){t.next=21;break}if(!Array.isArray(e)){t.next=14;break}return t.next=11,r;case 11:return t.abrupt("return",t.sent);case 14:return t.t0=parseInt,t.next=17,i.text();case 17:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 19:t.next=27;break;case 21:if(200!==i.status||"PATCH"!==n){t.next=25;break}return t.abrupt("return",r);case 25:c=new CustomEvent("arachneError",{detail:{method:"save",status:i.status}}),window.dispatchEvent(c);case 27:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}(),j=new(function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";Object(i.a)(this,t),""===e&&"http://localhost:3000"===window.location.origin?this.url="http://localhost:8080":this.url=e,this.key=null,this.me=null;var n=localStorage.getItem("dmlwOptions");n?(n=JSON.parse(n),this.options={z_width:n.z_width?n.z_width:500}):this.options={z_width:500}}return Object(c.a)(t,[{key:"setOptions",value:function(t,e){this.options[t]=e,localStorage.setItem("dmlwOptions",JSON.stringify(this.options))}},{key:"login",value:function(){var t=Object(r.a)(a.a.mark((function t(e,n){var s,r,i=arguments;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=i.length>2&&void 0!==i[2]?i[2]:null,t.next=3,fetch(this.url+"/session",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:e,password:n})});case 3:if(200!==(r=t.sent).status){t.next=11;break}return t.next=7,r.text();case 7:return this.key=t.sent,t.abrupt("return",this.open(s));case 11:return t.abrupt("return",!1);case 12:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"open",value:function(){var t=Object(r.a)(a.a.mark((function t(){var e,n,s,r,i,c=arguments;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=c.length>0&&void 0!==c[0]?c[0]:null,t.next=3,this.getUser();case 3:if(!(n=t.sent)){t.next=10;break}this.me=n,this.me.selectKey="ctrl",navigator.appVersion.indexOf("Mac")>-1&&(this.me.selectKey="cmd"),t.next=11;break;case 10:return t.abrupt("return",!1);case 11:if(null!=e){t.next=15;break}return t.next=14,this.tables();case 14:e=t.sent;case 15:s=Object(b.a)(e);try{for(s.s();!(r=s.n()).done;)this[i=r.value]=new m(i,this.url,this.key)}catch(a){s.e(a)}finally{s.f()}return t.abrupt("return",!0);case 18:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"close",value:function(){var t=Object(r.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.key=null;case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getUser",value:function(){var t=Object(r.a)(a.a.mark((function t(){var e;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(this.url+"/session",{headers:{Authorization:"Bearer ".concat(this.key)}});case 2:if(200!==(e=t.sent).status){t.next=9;break}return t.next=6,e.json();case 6:return t.abrupt("return",t.sent);case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"createAccount",value:function(){var t=Object(r.a)(a.a.mark((function t(e){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(this.url+"/data/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});case 2:return n=t.sent,t.abrupt("return",n.status);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"importScans",value:function(){var t=Object(r.a)(a.a.mark((function t(e){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(this.url+"/file/scan",{method:"POST",headers:{Authorization:"Bearer ".concat(this.key)},body:e});case 2:return n=t.sent,t.t0=n.status,t.next=6,n.json();case 6:return t.t1=t.sent,t.abrupt("return",{status:t.t0,body:t.t1});case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"importZettel",value:function(){var t=Object(r.a)(a.a.mark((function t(e){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(this.url+"/file/zettel",{method:"POST",body:e,headers:{Authorization:"Bearer ".concat(this.key)}});case 2:if(201==t.sent.status){t.next=6;break}throw alert("Ein Fehler ist aufgetreten! Bitte \xfcberpr\xfcfen Sie die hochgeladenen Zettel."),"Error: Fehler beim Zettel-Upload!";case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"exec",value:function(){var t=Object(r.a)(a.a.mark((function t(e){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(this.url+"/exec/"+e,{method:"GET",headers:{Authorization:"Bearer ".concat(this.key)}});case 2:return n=t.sent,t.abrupt("return",n.status);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"access",value:function(t){var e=this;return!!this.me&&("string"===typeof t&&(t=JSON.parse('["'.concat(t,'"]'))),t.every((function(t){return e.me.access.includes(t)})))}},{key:"getScan",value:function(){var t=Object(r.a)(a.a.mark((function t(e){var n,s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(this.url,"/file/scan/").concat(e),{headers:{Authorization:"Bearer ".concat(this.key)}}).then((function(t){return t.blob()}));case 2:return n=t.sent,s=URL.createObjectURL(n),t.abrupt("return",s);case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}()),g=n(17),v=n.n(g),y=n(0),O=function(t){Object(o.a)(n,t);var e=Object(l.a)(n);function n(t){var s;return Object(i.a)(this,n),(s=e.call(this,t)).item=t.item,s}return Object(c.a)(n,[{key:"render",value:function(){var t,e=this,n=[],s=Object(b.a)(this.props.searchOptions);try{for(s.s();!(t=s.n()).done;){var a=t.value;n.push(Object(y.jsx)("option",{value:a[0],children:a[1]},a[0]))}}catch(r){s.e(r)}finally{s.f()}return Object(y.jsxs)("div",{className:"searchFields mainColors",style:{boxShadow:"rgb(217, 217, 217) 0px 0px 2px",marginRight:"10px",marginBottom:"10px",padding:"10px 15px 10px 15px"},children:[Object(y.jsx)("select",{style:{width:"100px",marginRight:"0px",border:"none",color:"#284b63"},children:n}),Object(y.jsxs)("select",{style:{width:"40px",marginRight:"0px",border:"none",color:"#284b63"},children:[Object(y.jsx)("option",{value:"=",children:"="}),Object(y.jsx)("option",{value:"!=",children:"\u2260"}),Object(y.jsx)("option",{value:">",children:">"}),Object(y.jsx)("option",{value:">=",children:"\u2265"}),Object(y.jsx)("option",{value:"<",children:"<"}),Object(y.jsx)("option",{value:"<=",children:"\u2264"})]}),Object(y.jsx)("input",{type:"text",placeholder:"...",style:{width:"100px",marginRight:"22px",border:"none"},onKeyUp:function(t){13===t.keyCode&&e.props.clickButton()}}),Object(y.jsx)(x.a,{color:"LightGray",icon:f.m,onClick:function(){e.props.removeSearchFields(e.props.item.id)}})]})}}]),n}(d.a.Component),k=(d.a.Component,d.a.Component,function(t){Object(o.a)(n,t);var e=Object(l.a)(n);function n(t){var s;return Object(i.a)(this,n),(s=e.call(this,t)).state={id:s.props.status.id,visible:!1},s.statusBox=d.a.createRef(),s.timeOutHandle=null,s}return Object(c.a)(n,[{key:"render",value:function(){var t=this;if(this.state.visible){var e="",n=null;switch(this.state.type){case"searching":n=Object(y.jsx)("div",{style:{display:"inline-block",backgroundColor:"#246EB9"},children:Object(y.jsx)(x.a,{color:"#FDFFFC",style:{padding:"3px",fontSize:"40px"},icon:f.o,spin:!0})}),e="Suche l\xe4uft...",null!=this.timeOutHandle&&clearTimeout(this.timeOutHandle);break;case"found":n=Object(y.jsx)(x.a,{color:"#FDFFFC",style:{padding:"3px",backgroundColor:"#4CB944",fontSize:"40px"},icon:f.h}),e="Eintr\xe4ge gefunden!",null!=this.timeOutHandle&&clearTimeout(this.timeOutHandle),this.timeOutHandle=setTimeout((function(){t.statusBox.current.style.opacity="0",setTimeout((function(){t.setState({visible:!1})}),500)}),3e3);break;case"notFound":n=Object(y.jsx)(x.a,{color:"#FDFFFC",style:{padding:"3px",backgroundColor:"#353535",fontSize:"40px"},icon:f.d}),e="Keine Eintr\xe4ge gefunden!",null!=this.timeOutHandle&&clearTimeout(this.timeOutHandle),this.timeOutHandle=setTimeout((function(){t.statusBox.current.style.opacity="0",setTimeout((function(){t.setState({visible:!1})}),500)}),3e3);break;case"saved":n=Object(y.jsx)(x.a,{color:"#FDFFFC",style:{padding:"3px",backgroundColor:"#4CB944",fontSize:"40px"},icon:f.e}),e="Speichern erfolgreich.",null!=this.timeOutHandle&&clearTimeout(this.timeOutHandle),this.timeOutHandle=setTimeout((function(){t.statusBox.current.style.opacity="0",setTimeout((function(){t.setState({visible:!1})}),500)}),2e3);break;case"error":n=Object(y.jsx)(x.a,{color:"#FDFFFC",style:{padding:"3px",backgroundColor:"#F06543",fontSize:"40px"},icon:f.p}),e="Ein Fehler ist aufgetreten.",null!=this.timeOutHandle&&clearTimeout(this.timeOutHandle),this.timeOutHandle=setTimeout((function(){t.statusBox.current.style.opacity="0",setTimeout((function(){t.setState({visible:!1})}),500)}),3e3);break;case"saving":e="Eintr\xe4ge werden gespeichert.",n=Object(y.jsx)("div",{style:{display:"inline-block",backgroundColor:"#246EB9"},children:Object(y.jsx)(x.a,{color:"#FDFFFC",style:{padding:"3px",fontSize:"40px"},icon:f.o,spin:!0})}),null!=this.timeOutHandle&&clearTimeout(this.timeOutHandle),this.timeOutHandle=null;break;default:e="Programm arbeitet.",n=Object(y.jsx)(x.a,{color:"#FDFFFC",style:{padding:"3px",backgroundColor:"#F5EE9E",fontSize:"40px"},icon:f.f}),null!=this.timeOutHandle&&clearTimeout(this.timeOutHandle),this.timeOutHandle=setTimeout((function(){t.statusBox.current.style.opacity="0",setTimeout((function(){t.setState({visible:!1})}),500)}),2e3)}return null!=this.state.value&&(e=this.state.value),Object(y.jsxs)("div",{ref:this.statusBox,style:{position:"fixed",bottom:"30px",left:"30px",boxShadow:"0 2px 5px #d9d9d9",transition:"opacity 0.5s",opacity:"1",borderRadius:"3px",overflow:"hidden",zIndex:9e6},className:"mainColors",children:[n,Object(y.jsx)("span",{style:{position:"relative",top:"-10px",padding:"10px 20px"},children:e})]})}return null}},{key:"componentDidUpdate",value:function(){this.props.status.id!=this.state.id&&this.setState({id:this.props.status.id,visible:!0,type:this.props.status.type,value:this.props.status.value})}}]),n}(d.a.Component)),w=function(t){Object(o.a)(n,t);var e=Object(l.a)(n);function n(){return Object(i.a)(this,n),e.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var t,e=this,n=[],s=Object(b.a)(this.props.options);try{for(s.s();!(t=s.n()).done;){var a=t.value;n.push(Object(y.jsx)("option",{value:a[0],children:a[1]},a[0]))}}catch(r){s.e(r)}finally{s.f()}return Object(y.jsxs)("div",{style:this.props.style,children:[Object(y.jsx)("select",{className:this.props.classList,value:this.props.value,style:{width:"100%"},onChange:function(t){e.props.onChange(t)},children:n}),Object(y.jsx)("div",{style:{pointerEvents:"none",textAlign:"right",margin:"-26px 10px 0 0"},children:Object(y.jsx)(x.a,{color:"LightGray",icon:f.a})})]})}}]),n}(d.a.Component),S=(d.a.Component,function(t){Object(o.a)(n,t);var e=Object(l.a)(n);function n(t){return Object(i.a)(this,n),e.call(this,t)}return Object(c.a)(n,[{key:"render",value:function(){var t=this;return Object(y.jsx)("div",{className:"selectWrapper"+("1"===this.props.isSelected?" selMarked":""),style:{transition:"box-shadow 0.3s",margin:"10px 5px"},id:this.props.children.props.id,ref:this.element,onClick:function(t){t.stopPropagation()},onMouseUp:function(e){t.props.onSelect(t.props.children,{shift:e.shiftKey,meta:e.metaKey,ctrl:e.ctrlKey})},children:this.props.children})}}]),n}(d.a.Component)),C=function(t){Object(o.a)(n,t);var e=Object(l.a)(n);function n(t){var s;Object(i.a)(this,n);var a={};return(s=e.call(this,t)).props.multiSelect&&(a.userSelect="none",a.msUserSelect="none",a.WebkitUserSelect="none"),s.state={currentId:0,ids:[],style:a},s}return Object(c.a)(n,[{key:"render",value:function(){var t=this,e=d.a.Children.map(this.props.children,(function(e){return Object(y.jsx)(S,{isSelected:t.state.ids.includes(e.props.id)?"1":"0",onSelect:function(e,n){t.select(e,n)},children:e})}));return Object(y.jsx)("div",{style:this.state.style,className:this.props.className,onClick:function(){t.select(null,{})},children:e})}},{key:"select",value:function(t,e){var n=this;if(null===t)this.setState({currentId:0,ids:[]}),this.props.selectCallback(null,{currentId:0,ids:[]});else{var s=t.props.id;if(this.props.multiSelect&&e.shift){var a=!1,r=[];d.a.Children.forEach(this.props.children,(function(t){0!=a||t.props.id!==s&&t.props.id!==n.state.currentId?a&&t.props.id!==s&&t.props.id!==n.state.currentId?r.push(t.props.id):a&&(a=!1,r.push(t.props.id)):(a=!0,r.push(t.props.id))})),this.setState({currentId:s,ids:r}),this.props.selectCallback(t,{currentId:s,ids:r})}else if(this.props.multiSelect&&("cmd"===j.me.selectKey&&e.meta||"ctrl"===j.me.selectKey&&e.ctrl)){var i=this.state.ids;i.includes(s)?i=i.filter((function(t){return t!=s})):i.push(s),this.setState({currentId:s,ids:i}),this.props.selectCallback(t,{currentId:s,ids:i})}else this.setState({currentId:s,ids:[s]}),this.props.selectCallback(t,{currentId:s,ids:[s]})}}},{key:"componentDidUpdate",value:function(t){t.preset!=this.props.preset&&(setTimeout((function(){var t=document.querySelector("div.selMarked");t&&t.scrollIntoView({behavior:"smooth",block:"center"})}),300),this.setState({ids:this.props.preset}))}}]),n}(d.a.Component);function T(t){return null==t?{__html:null}:{__html:v.a.sanitize(t.replace(/&lt;/g,"<").replace(/&gt;/g,">"),{ADD_TAGS:["aut","gruen","gelb","rot","blau"]})}}var I=function(t){Object(o.a)(n,t);var e=Object(l.a)(n);function n(t){var s;return Object(i.a)(this,n),(s=e.call(this,t)).state={mounted:!1,mode:"img",imgURL:null,fullTextEdit:!1,scanLst:[],zoomFactor:100,scanLstSelected:[],contentMode:"pages",scansInPath:[],allScansPresetSelection:[],allScansSelection:[],ocrReady:!1,work:{},displayBibliography:!1},window.addEventListener("keyup",(function(t){"TEXTAREA"!=t.target.tagName&&37===t.keyCode&&s.state.cIndex>0?s.setState({cIndex:s.state.cIndex-1}):"TEXTAREA"!=t.target.tagName&&39===t.keyCode&&s.state.cIndex<s.state.scanLst.length-1&&s.setState({cIndex:s.state.cIndex+1})})),s}return Object(c.a)(n,[{key:"render",value:function(){var t=this,e=[];if(this.state.contentMenu){var n,s=-1,i=Object(b.a)(this.state.scanLst);try{for(i.s();!(n=i.n()).done;){var c=n.value;s++,e.push(Object(y.jsxs)("li",{children:[c.full_text?Object(y.jsx)(x.a,{icon:f.l,style:{fontSize:"10px",margin:"0 5px 1px 0"}}):null,Object(y.jsx)("a",{id:s,style:{color:this.state.scanLstSelected.includes(c.id)?"red":"inherit"},onClick:function(e){t.setState({cIndex:parseInt(e.target.id),contentMenu:!1})},children:isNaN(c.filename)?c.filename:parseInt(c.filename)})]},s))}}catch(O){i.e(O)}finally{i.f()}}var o={position:"relative",margin:"60px 40px 60px 40px",display:"grid",gridTemplateColumns:"img"===this.state.mode||"text"===this.state.mode?"1fr":"1fr 1fr",gridTemplateRows:"1fr",columnGap:"20px"};this.state.contentMenu&&(o.left="150px");var l=Object(y.jsx)("i",{children:"Kein Flie\xdftext verf\xfcgbar."});this.state.txt&&!this.state.fullTextEdit?l=Object(y.jsx)("span",{style:{fontSize:"18px"},dangerouslySetInnerHTML:T(this.state.txt.replace(new RegExp("".concat(this.state.currentQuery),"g"),"<mark>".concat(this.state.currentQuery,"</mark>")).replace(/\n/g,"<br />"))}):this.state.fullTextEdit&&(l=Object(y.jsx)("textarea",{style:{outline:"none",resize:"none",width:"100%",height:"500px"},value:this.state.txt?this.state.txt:"",onChange:function(e){t.setState({txt:e.target.value})},onBlur:function(e){t.props.status("saving"),j.scan.save({id:t.state.scanLst[t.state.cIndex].scan_id,full_text:e.target.value}),t.props.status("saved")}}));var u=null;if("pages"===this.state.contentMode)u=Object(y.jsxs)("div",{style:{padding:"20px"},children:[j.access("e_edit")?Object(y.jsx)(x.a,{className:"editButton",style:{position:"absolute",top:"10px",right:"10px",fontSize:"15px"},icon:f.i,onClick:function(){t.setState({contentMode:"edit"})}}):null,Object(y.jsx)("h4",{children:"Inhalt"}),Object(y.jsx)("ul",{style:{listStyleType:"none",margin:"0",padding:"0"},children:e}),Object(y.jsx)("div",{style:{height:"70px"}}),Object(y.jsx)("div",{className:"mainColors",style:{position:"fixed",bottom:"42px",left:"0",width:"180px",borderTop:"0.5px solid gray",padding:"4px 5px"},children:Object(y.jsx)("input",{type:"text",style:{margin:"3px 1px",padding:"0",boxShadow:"none",width:"170px"},onKeyUp:function(){var e=Object(r.a)(a.a.mark((function e(n){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(13!==n.keyCode){e.next=5;break}return e.next=3,j.scan_lnk.search([{c:"edition_id",o:"=",v:t.props.edition},{c:"full_text",o:"=",v:"*".concat(n.target.value,"*")}],{select:["id"]});case 3:s=e.sent,t.setState({currentQuery:n.target.value,scanLstSelected:s.map((function(t){return t.id}))});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})})]});else if("edit"===this.state.contentMode){var d,p=[],h=0,m=Object(b.a)(this.state.scansInPath);try{for(m.s();!(d=m.n()).done;){var g=d.value;h++,p.push(Object(y.jsx)("div",{className:"all_scans_item",id:g.id,children:g.filename},h))}}catch(O){m.e(O)}finally{m.f()}u=Object(y.jsxs)("div",{style:{paddingBottom:"60px"},children:[Object(y.jsxs)("div",{style:{position:"sticky",top:"0px",backgroundColor:"white",marginBottom:"20px",borderBottom:"1px solid lightgray",padding:"5px 10px 15px 10px"},children:[Object(y.jsx)("div",{style:{marginBottom:"30px"},children:j.access("e_edit")?Object(y.jsx)(x.a,{className:"editButton",style:{position:"absolute",top:"10px",right:"10px",fontSize:"15px"},icon:f.i,onClick:function(){t.setState({contentMode:"pages"})}}):null}),this.state.allScansSelection.length,Object(y.jsx)("input",{type:"button",onClick:Object(r.a)(a.a.mark((function e(){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.props.status("saving"),!(t.state.scanLst.length>0)){e.next=4;break}return e.next=4,j.scan_lnk.delete(t.state.scanLst.map((function(t){return t.id})));case 4:if(!((n=t.state.allScansSelection.map((function(e){return{edition_id:t.props.edition,scan_id:e}}))).length>0)){e.next=8;break}return e.next=8,j.scan_lnk.save(n);case 8:t.props.status("saved"),setTimeout((function(){window.location.reload()}),500);case 10:case"end":return e.stop()}}),e)}))),value:"speichern",style:{fontSize:"15px",float:"right"}})]}),Object(y.jsx)(C,{multiSelect:!0,className:"all_scans",selectCallback:function(e,n){console.log("beep in Selector"),j.getScan(n.currentId).then((function(e){t.setState({imgURL:e,txt:""})})).catch((function(t){throw t})),t.setState({allScansSelection:n.ids})},preset:this.state.allScansPresetSelection,children:p})]})}var v="";if(this.state.scanLst.length-1>=this.state.cIndex&&null!=this.state.scanLst[this.state.cIndex]){v=this.state.scanLst[this.state.cIndex].filename;try{v=parseInt(v)}catch(k){}}return Object(y.jsxs)("div",{children:[Object(y.jsxs)("main",{style:o,children:[this.state.mounted&&"pages"===this.state.contentMode&&0===this.state.scanLst.length?"FEHLER: Keine Seiten f\xfcr diese Ressource gefunden! Melden Sie die ID ".concat(this.props.edition,"."):null,this.state.imgURL&&("img"===this.state.mode||"split"===this.state.mode)&&Object(y.jsx)("div",{style:{textAlign:"center"},children:Object(y.jsx)("img",{src:this.state.imgURL,style:{boxShadow:"0 2px 3px gray",width:"img"===this.state.mode?this.state.zoomFactor+"%":"100%"}})}),("text"===this.state.mode||"split"===this.state.mode)&&Object(y.jsxs)("div",{style:{boxShadow:"0 2px 3px gray",padding:"20px 40px",position:"relative"},children:[Object(y.jsxs)("div",{className:"minorTxt",style:{textAlign:"center",marginBottom:"30px"},children:[Object(y.jsx)("span",{dangerouslySetInnerHTML:T(this.state.title)}),Object(y.jsx)("span",{style:{float:"right"},children:this.state.page})]}),Object(y.jsx)("div",{style:{textAlign:"justify"},children:l}),j.access("e_edit")?Object(y.jsx)(x.a,{icon:f.i,style:{position:"absolute",bottom:"10px",right:"10px",color:"gray"},onClick:function(){t.state.fullTextEdit?t.setState({fullTextEdit:!1}):t.setState({fullTextEdit:!0})}}):null]}),this.state.cIndex>0?Object(y.jsx)("div",{className:"leftArrow",onClick:function(){t.setState({cIndex:t.state.cIndex-1})}}):null,this.state.cIndex<this.state.scanLst.length-1?Object(y.jsx)("div",{className:"rightArrow",onClick:function(){t.setState({cIndex:t.state.cIndex+1})}}):null]}),this.state.contentMenu?Object(y.jsx)("div",{className:"mainColors",style:{position:"fixed",top:"43px",left:"0",bottom:"0",width:"200px",boxShadow:"0 0 2px gray",overflow:"scroll"},children:u}):null,Object(y.jsxs)("header",{className:"mainColors",style:{position:"fixed",top:"0",right:"0",left:"0",boxShadow:"0 0 2px gray",display:"grid",gridTemplateColumns:"1fr 1fr"},children:[Object(y.jsxs)("div",{children:[null,Object(y.jsx)(x.a,{icon:f.c,style:{fontSize:"30px",margin:"5px 0 2px 25px"},onClick:function(){t.state.contentMenu?t.setState({contentMenu:!1,contentMode:"pages"}):t.setState({contentMenu:!0})}}),Object(y.jsx)("div",{style:{position:"absolute",top:"10px",left:"120px"},children:this.state.work.id>0?Object(y.jsx)("span",{dangerouslySetInnerHTML:T(this.state.work.opus)}):Object(y.jsx)("span",{style:{color:"red",margin:"0px 25px 0px 0px"},children:"Fehler: Die Ressource ist mit keinem Werk verkn\xfcpft!"})})]}),Object(y.jsxs)("div",{style:{textAlign:"right"},children:[null,this.state.ocrReady?Object(y.jsx)(x.a,{icon:f.j,style:{fontSize:"25px",margin:"0px 25px 6px 0"},onClick:Object(r.a)(a.a.mark((function e(){var n,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t.state.txt&&!window.confirm("Ein Volltext ist bereits verf\xfcgbar. Soll er \xfcberschrieben werden?")){e.next=8;break}return t.props.status("searching","Text wird konvertiert..."),e.next=4,t.worker.recognize(t.state.imgURL);case 4:n=e.sent,s=n.data.text,t.setState({txt:s}),t.props.status("found","Text hinzugef\xfcgt!");case 8:case"end":return e.stop()}}),e)})))}):null,Object(y.jsx)(x.a,{icon:f.k,style:{fontSize:"35px",margin:"5px 25px 3px 0"},onClick:function(){t.setState({mode:"img"})}}),Object(y.jsx)(x.a,{icon:f.g,style:{fontSize:"30px",margin:"0 20px 5px 0"},onClick:function(){t.setState({mode:"split"})}}),Object(y.jsx)(x.a,{icon:f.l,style:{fontSize:"33px",margin:"0 30px 4px 0"},onClick:function(){t.setState({mode:"text"})}})]})]}),Object(y.jsxs)("footer",{className:"mainColors",style:{position:"fixed",bottom:"0",right:"0",left:"0",boxShadow:"0 0 2px gray",display:"grid",gridTemplateColumns:"1fr 1fr",height:"43px"},children:[Object(y.jsxs)("div",{style:{position:"relative",top:"1px",left:"10px"},children:[Object(y.jsx)("input",{style:{position:"relative",top:"7px",marginRight:"10px",width:"400px"},type:"range",min:"0",max:this.state.scanLst.length-1,value:this.state.cIndex,onChange:function(e){t.setState({cIndex:parseInt(e.target.value)})},className:"slider"}),Object(y.jsxs)("span",{children:["p. ",v]})]}),Object(y.jsx)("div",{style:{textAlign:"right"},children:"img"===this.state.mode?Object(y.jsxs)("div",{style:{position:"relative",top:"1px",right:"10px"},children:[Object(y.jsxs)("span",{children:[this.state.zoomFactor,"%"]}),Object(y.jsx)("input",{style:{position:"relative",top:"7px",marginLeft:"10px",width:"400px"},type:"range",min:"0",max:"200",value:this.state.zoomFactor,onChange:function(e){t.setState({zoomFactor:parseInt(e.target.value)})},className:"slider"})]}):null})]}),this.state.displayBibliography?Object(y.jsx)("div",{className:"bibliographyBox",children:this.state.work.bibliography}):null]})}},{key:"componentDidMount",value:function(){var t=this;(function(){var e=Object(r.a)(a.a.mark((function e(){var n,s,r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.edition.get({id:t.props.edition});case 2:return 0===(n=e.sent).length&&alert("Ein Fehler ist aufgetreten: Die Ressource konnte nicht gefunden werden. Melden Sie die ID ".concat(t.props.edition)),e.next=6,j.work.get({id:n[0].work_id});case 6:return s=e.sent,console.log(s),s=1===s.length?s[0]:{},e.next=11,j.scan_lnk.get({edition_id:t.props.edition});case 11:r=(r=e.sent).sort((function(t,e){return e.filename<t.filename})),i=1===n.length?"".concat(n[0].opus.replace(" <cit></cit>","")," (").concat(n[0].label,")"):"",t.setState({mounted:!0,title:i,path:n[0].path,edition:n[0],scanLst:r,cIndex:r.length-1,work:s});case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}},{key:"componentDidUpdate",value:function(t,e){var n=this;(e.cIndex!=this.state.cIndex&&this.state.scanLst.length>0&&j.getScan(this.state.scanLst[this.state.cIndex].scan_id).then((function(t){n.setState({imgURL:t,txt:n.state.scanLst[n.state.cIndex].full_text,page:isNaN(n.state.scanLst[n.state.cIndex].filename)?n.state.scanLst[n.state.cIndex].filename:parseInt(n.state.scanLst[n.state.cIndex].filename)})})).catch((function(t){throw t})),"pages"===e.contentMode&&"edit"===this.state.contentMode)&&function(){var t=Object(r.a)(a.a.mark((function t(){var e,s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.scan.get({path:n.state.path});case 2:e=t.sent,s=n.state.scanLst.map((function(t){return t.scan_id})),n.setState({scansInPath:e,allScansPresetSelection:s,allScansSelection:s});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()}}]),n}(d.a.Component),A=n(18);function N(){var t=Object(u.useState)([]),e=Object(A.a)(t,2),n=e[0];e[1];return Object(u.useEffect)((function(){(function(){var t=Object(r.a)(a.a.mark((function t(){var e;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("getting data..."),t.next=3,j.opera_maiora.getAll();case 3:return e=t.sent,t.next=6,j.opera_minora.getAll();case 6:t.sent,console.log("data downloaded."),console.log(e.slice(0,10));case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[]),Object(y.jsx)("div",{children:Object(y.jsxs)("div",{style:{margin:"20px 40px 20px 40px",padding:"10px 20px",boxShadow:"0 0 4px gray"},children:[Object(y.jsx)("h1",{children:"\xdcbersicht"}),Object(y.jsx)("table",{children:Object(y.jsx)("tbody",{children:n})})]})})}var F=function(t){Object(o.a)(n,t);var e=Object(l.a)(n);function n(t){var s;return Object(i.a)(this,n),(s=e.call(this,t)).state={mode:"login",site:"edition",status:{}},window.addEventListener("arachneError",(function(t){401===t.detail.status?s.newStatus("error","Der Server hat die Zugangsdaten abgelehnt. Melden Sie sich neu an!"):s.newStatus("error","Die Verbindung zum Server ist unterbrochen.")})),s.tbls=["edition","lemma","opera_maiora","opera_minora","scan","scan_lnk","work","zettel","user"],s}return Object(c.a)(n,[{key:"render",value:function(){var t=this;if("main"===this.state.mode){var e=null;switch(this.state.site){case"overview":e=Object(y.jsx)(N,{});break;default:e=Object(y.jsx)(I,{edition:this.state.edition,status:function(e,n){t.newStatus(e,n)},setSite:function(e){t.setState({site:e})}})}return Object(y.jsxs)("div",{children:[e,Object(y.jsx)(k,{status:this.state.status})]})}return"create"===this.state.mode?Object(y.jsxs)("div",{style:{position:"absolute",display:"grid",height:"100%",width:"100%",gridTemplateColumns:"1fr 2fr 1fr",gridTemplateRows:"1fr 2fr 1fr"},children:[Object(y.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gridTemplateRows:"auto 100px 50px 50px 50px 50px 50px auto",gridColumn:"2",gridRow:"2",padding:"10px 15px",borderRadius:"5px",boxShadow:"0 1.2px 6px #3c6e71"},children:[Object(y.jsx)("h1",{style:{textAlign:"center",gridArea:"2/2/2/4"},children:"Konto erstellen"}),Object(y.jsx)("span",{style:{gridArea:"3/2/3/3"},children:"Vorname:"}),Object(y.jsx)("div",{style:{gridArea:"3/3/3/4"},children:Object(y.jsx)("input",{type:"text",value:this.state.createFirstName?this.state.createFirstName:"",onChange:function(e){t.setState({createFirstName:e.target.value})}})}),Object(y.jsx)("span",{style:{gridArea:"4/2/4/3"},children:"Nachname:"}),Object(y.jsx)("div",{style:{gridArea:"4/3/4/4"},children:Object(y.jsx)("input",{type:"text",value:this.state.createLastName?this.state.createLastName:"",onChange:function(e){t.setState({createLastName:e.target.value})}})}),Object(y.jsx)("span",{style:{gridArea:"5/2/5/3"},children:"E-Mail:"}),Object(y.jsx)("div",{style:{gridArea:"5/3/5/4"},children:Object(y.jsx)("input",{type:"text",value:this.state.createEmail?this.state.createEmail:"",onChange:function(e){t.setState({createEmail:e.target.value})}})}),Object(y.jsx)("span",{style:{gridArea:"6/2/6/3"},children:"Passwort:"}),Object(y.jsx)("div",{style:{gridArea:"6/3/6/4"},children:Object(y.jsx)("input",{type:"password",value:this.state.createPassword?this.state.createPassword:"",onChange:function(e){t.setState({createPassword:e.target.value})}})}),Object(y.jsxs)("div",{style:{gridArea:"8/3/8/4"},children:[Object(y.jsx)("input",{type:"button",value:"registrieren",onClick:Object(r.a)(a.a.mark((function e(){var n,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.state.createFirstName&&t.state.createFirstName&&t.state.createEmail&&t.state.createPassword)){e.next=19;break}return t.newStatus("saving"),n={first_name:t.state.createFirstName,last_name:t.state.createLastName,email:t.state.createEmail,password:t.state.createPassword},e.next=5,j.createAccount(n);case 5:s=e.sent,e.t0=s,e.next=201===e.t0?9:409===e.t0?12:406===e.t0?14:16;break;case 9:return t.newStatus("saved","Der Account wurde erfolgreich erstellt."),setTimeout((function(){t.setState({mode:"login"})}),2100),e.abrupt("break",17);case 12:return t.newStatus("error","Die Email-Adresse ist bereits vorhanden."),e.abrupt("break",17);case 14:return t.newStatus("error","Bitte f\xfcllen Sie alle Felder aus."),e.abrupt("break",17);case 16:t.newStatus("error","Die Registrierung is fehlgeschlagen. Versuchen Sie es erneut.");case 17:e.next=20;break;case 19:t.newStatus("error","Bitte f\xfcllen Sie alle Felder aus!");case 20:case"end":return e.stop()}}),e)})))})," ",Object(y.jsx)("span",{className:"minorTxt",style:{marginLeft:"20px"},children:Object(y.jsx)("a",{onClick:function(){t.setState({mode:"login"})},children:"zur\xfcck"})})]}),Object(y.jsx)("span",{style:{gridArea:"7/2/7/3"}})]}),Object(y.jsx)(k,{status:this.state.status})]}):Object(y.jsxs)("div",{style:{position:"absolute",display:"grid",height:"100%",width:"100%",gridTemplateColumns:"1fr 2fr 1fr",gridTemplateRows:"1fr 2fr 1fr"},children:[Object(y.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gridTemplateRows:"auto 100px 50px 50px 50px 25px 50px auto",gridColumn:"2",gridRow:"2",padding:"10px 15px",borderRadius:"5px",boxShadow:"0 1.2px 6px #3c6e71"},children:[Object(y.jsx)("h1",{style:{textAlign:"center",gridArea:"2/2/2/4"},children:"dMLW"}),Object(y.jsx)("span",{style:{gridArea:"3/2/3/3"},children:"Email:"}),Object(y.jsx)("div",{style:{gridArea:"3/3/3/4"},children:Object(y.jsx)("input",{type:"text",name:"email",style:{width:"300px"}})}),Object(y.jsx)("span",{style:{gridArea:"4/2/4/3"},children:"Passwort:"}),Object(y.jsx)("div",{style:{gridArea:"4/3/4/4"},children:Object(y.jsx)("input",{type:"password",name:"password",style:{width:"300px"}})}),Object(y.jsx)("div",{style:{gridArea:"5/3/5/4"},children:Object(y.jsx)("input",{type:"submit",value:"anmelden",onClick:function(){t.login()}})}),Object(y.jsxs)("span",{style:{gridArea:"7/2/7/4"},className:"minorTxt",children:["Noch kein Konto? Klicken Sie ",Object(y.jsx)("a",{onClick:function(){t.setState({mode:"create"})},children:"hier"}),"."]})]}),Object(y.jsx)("div",{className:"cat",children:Object(y.jsx)(x.a,{color:"black",icon:f.d})})]})}},{key:"componentDidMount",value:function(){var t=this,e=new URLSearchParams(window.location.search);this.setState({edition:e.get("edition")?e.get("edition"):1,page:e.get("page")?e.get("page"):null}),function(){var e=Object(r.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.getUser();case 2:if(!e.sent){e.next=7;break}return e.next=6,j.open(t.tbls);case 6:t.setState({mode:"main"});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}},{key:"loadMain",value:function(t){"logout"===t?(j.close(),this.setState({mode:"login",res:null})):this.setState({res:t})}},{key:"login",value:function(){var t=Object(r.a)(a.a.mark((function t(){var e,n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.querySelector("input[name=email]").value,n=document.querySelector("input[name=password]").value,t.t0=""!==e&&""!==n,!t.t0){t.next=7;break}return t.next=6,j.login(e,n,this.tbls);case 6:t.t0=t.sent;case 7:if(!t.t0){t.next=11;break}this.setState({mode:"main"}),t.next=12;break;case 11:alert("Geben Sie eine g\xfcltige Email-Adresse und Passwort ein!");case 12:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"newStatus",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.setState({status:{id:Date.now(),visible:!0,type:t,value:e}})}}]),n}(d.a.Component);h.a.render(Object(y.jsx)(F,{}),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.1b0bca8d.chunk.js.map