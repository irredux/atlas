<!DOCTYPE html>
<html>
    <head>
        <link rel="shortcut icon" href="#" />
        <title>dMLW</title>
        <link rel="stylesheet" type="text/css" href="/file/css/screen.css">
        <script>
            async function login(){
                const re = await fetch("/session", {
                    method: "post",
                    headers: {"Content-Type": "application/json"},
                    body: JSON.stringify({
                        user: document.getElementById("email").value,
                        password: document.getElementById("password").value
                    })
                });
                if(re.status !=200){
                    alert("FEHLER BEIM LOGIN!");
                } else {
                    const key = await re.text();
                    localStorage.setItem("key", key);
                    window.open("/site", "_self");
                }
            }
                    /*
        document.body.addEventListener("keypress", function enterLogin(){
            if(event.keyCode == 13){
                this.removeEventListener("keypress", enterLogin);
                submitLogin.click();
            }
        });
        let deleteDB = document.createElement("A");
        deleteDB.textContent = "Lokale Datenbank zurücksetzen";
        deleteDB.onclick = () => {
            return new Promise((resolve, reject) => {
                let request = indexedDB.deleteDatabase(arachne.dbName);
                request.onerror = () => {el.status("error");reject()}
                request.onsuccess = () => {el.status("updated", "Datenbank gelöscht.");resolve()}
            });
        }
        */
        </script>
    </head>
    <body>
        <div id="header">
            <h1>dMLW</h1>
            <p>Ein digitales Angebot des MLW.</p>
        </div>
        <div id="login" style="padding: 20px 25%">
            <fieldset>
                <h2>Login</h2>
                <p>E-Mail:</p><input id="email" type="text" />
                <p>Passwort:</p><input id="password" type="password" />
                <p>
                    Noch kein Benutzerkonto? <a onclick="argos.loadMain('account_create')">hier klicken</a>
                    <!--<br />
                        Passwort vergessen? <a onclick="argos.loadMain('account_forgotten')">hier klicken</a>
                    -->
                    <br />
                </p>
                <input type="button" onclick="login()" value="Login" style="float:right;" />

            </fieldset>
        </div>
        <div id="footer">
            <p class="minorTxt" style="float: left;">
                <a href="mailto:alexander.haeberlin@mlw.badw.de"/>Kontakt</a>
            </p>
            <p class="minorTxt">Beta 9.5 - 5. Juli 2021</p>
        </div>
    </body>
</html>
